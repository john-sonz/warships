(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.config = {
    board: [10, 10],
    shipsSizes: [1, 1, 1, 1, 2, 2, 2, 3, 3, 4]
};

},{}],2:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var colors = ["blue", "red", "green", "yellow"];
var Board = /** @class */ (function () {
    function Board(width, height) {
        var _a;
        this.board = [];
        this.htmlBoard = [];
        this.ships = [];
        this.lastProposed = null;
        _a = [width, height], this.width = _a[0], this.height = _a[1];
        for (var i = 0; i < height; i++) {
            var row = [];
            for (var j = 0; j < width; j++) {
                row.push(0);
            }
            this.board.push(row);
        }
    }
    Board.prototype.createHTMLBoard = function (shipSetter) {
        var _this = this;
        if (shipSetter === void 0) { shipSetter = null; }
        this.boardContainer = document.createElement("div");
        this.boardContainer.className = "board";
        for (var i = 0; i < this.height; i++) {
            var row = [];
            var rowDiv = document.createElement('div');
            rowDiv.className = "row";
            for (var j = 0; j < this.width; j++) {
                var cell = document.createElement("div");
                if (shipSetter) {
                    cell.addEventListener('mouseover', function (e) { return _this.checkShip(e, shipSetter); });
                }
                cell.className = "cell";
                cell.id = j + "-" + i;
                row.push(cell);
                rowDiv.appendChild(cell);
            }
            this.htmlBoard.push(row);
            this.boardContainer.appendChild(rowDiv);
        }
    };
    Board.prototype.getHMTLBoard = function () { return this.boardContainer; };
    Board.prototype.addShip = function (x, y, length, direction) {
        if (direction === void 0) { direction = false; }
        for (var i = 0; i < length; i++) {
            var _a = [x, y], X = _a[0], Y = _a[1];
            if (direction)
                Y = y + i;
            else
                X = x + i;
            this.board[Y][X] = 1;
            this.htmlBoard[Y][X].classList.add('blue');
        }
    };
    Board.prototype.drawShips = function (shipSizes) {
        while (shipSizes.length > 0) {
            var size = shipSizes.pop();
            var found = false;
            while (!found) {
                var _a = [Math.floor(Math.random() * this.width), Math.floor(Math.random() * this.height), Math.random() < 0.5], x = _a[0], y = _a[1], direction = _a[2];
                if (x > this.width - size && !direction) {
                    continue;
                }
                if (y > this.height - size && direction) {
                    continue;
                }
                if (size === 4) {
                    this.addShip(x, y, size, direction);
                    break;
                }
                var _b = generateCheckPositions(x, y, size, this.width, this.height, direction), shipsPos = _b[0], surroundings = _b[1];
                found = this.checkPositions(shipsPos, surroundings);
                if (found)
                    this.addShip(x, y, size, direction);
            }
        }
    };
    Board.prototype.checkPositions = function (ships, surroundings) {
        var _this = this;
        var s = ships.filter(function (pos) {
            return _this.board[pos[1]][pos[0]] === 0;
        });
        var sur = surroundings.filter(function (pos) {
            return _this.board[pos[1]][pos[0]] === 0;
        });
        return (ships.length === s.length && surroundings.length === sur.length);
    };
    Board.prototype.viewShip = function (color, s) {
        var x = s.x, y = s.y, direction = s.direction, size = s.size;
        for (var i = 0; i < size; i++) {
            var _a = [x, y], X = _a[0], Y = _a[1];
            if (direction)
                Y = y + i;
            else
                X = x + i;
            if (X >= 0 && X < this.width && Y >= 0 && Y < this.height) {
                this.board[Y][X] = 1;
                this.htmlBoard[Y][X].style.backgroundColor = color;
            }
        }
        this.lastProposed = s;
    };
    Board.prototype.checkShip = function (e, shipSetter) {
        var el = e.target;
        var pos = el.id.split("-").map(function (a) { return parseInt(a); });
        var ship = {
            x: pos[0],
            y: pos[1],
            direction: shipSetter.direction,
            size: shipSetter.selected
        };
        if (this.lastProposed) {
            this.viewShip("", this.lastProposed);
        }
        this.viewShip("red", ship);
    };
    return Board;
}());
exports.default = Board;
function generateCheckPositions(x, y, length, width, height, direction) {
    if (direction === void 0) { direction = false; }
    var positions = [];
    for (var i = -1; i < 2; i++) {
        if (!direction) {
            for (var j = -1; j < length + 1; j++) {
                positions.push([x + j, y + i]);
            }
        }
        else {
            for (var j = -1; j < length + 1; j++) {
                positions.push([x + i, y + j]);
            }
        }
    }
    var shipPos = positions.splice(length + 3, length);
    return [shipPos, positions.filter(function (pos) {
            return (pos[0] >= 0 && pos[0] < width) && (pos[1] >= 0 && pos[1] < height);
        })];
}

},{}],3:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var ShipSetter = /** @class */ (function () {
    function ShipSetter(ships) {
        var _this = this;
        this.getContainer = function () { return _this.container; };
        this.direction = true;
        this.ships = ships.slice();
        this.container = document.getElementById("ships");
        this.selected = Math.max.apply(Math, ships);
        for (var i = ships.length - 1; i >= 0; i--) {
            var ship = document.createElement("div");
            ship.id = "" + ships[i];
            ship.className = "ship";
            ship.addEventListener("click", function (e) {
                var a = document.getElementsByClassName("selected")[0];
                a.classList.remove("selected");
                var el = e.currentTarget;
                el.classList.add('selected');
                _this.selected = parseInt(el.id);
            });
            for (var j = 0; j < ships[i]; j++) {
                var cell = document.createElement("div");
                ship.appendChild(cell);
            }
            this.container.appendChild(ship);
        }
        document.getElementsByClassName('ship')[0].classList.add("selected");
    }
    return ShipSetter;
}());
exports.default = ShipSetter;

},{}],4:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var config_1 = require("./../config");
var Board_1 = require("./Board");
var ShipSetter_1 = require("./ShipSetter");
var board = config_1.config.board, shipsSizes = config_1.config.shipsSizes;
var machineBoard = new Board_1.default(board[0], board[1]);
var playerBoard = new Board_1.default(board[0], board[1]);
var shipSetter = new ShipSetter_1.default(shipsSizes);
machineBoard.createHTMLBoard();
playerBoard.createHTMLBoard(shipSetter);
document.getElementById("machine").appendChild(machineBoard.getHMTLBoard());
document.getElementById("player").appendChild(playerBoard.getHMTLBoard());
machineBoard.drawShips(shipsSizes.slice());

},{"./../config":1,"./Board":2,"./ShipSetter":3}]},{},[4])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJzcmMvY29uZmlnLnRzIiwic3JjL3RzL0JvYXJkLnRzIiwic3JjL3RzL1NoaXBTZXR0ZXIudHMiLCJzcmMvdHMvbWFpbi50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTs7O0FDS2EsUUFBQSxNQUFNLEdBQVc7SUFDMUIsS0FBSyxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQztJQUNmLFVBQVUsRUFBRSxDQUFDLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsQ0FBQztDQUM3QyxDQUFBOzs7OztBQ0pELElBQUksTUFBTSxHQUFhLENBQUMsTUFBTSxFQUFFLEtBQUssRUFBRSxPQUFPLEVBQUUsUUFBUSxDQUFDLENBQUM7QUFTMUQ7SUFRSSxlQUFZLEtBQWEsRUFBRSxNQUFjOztRQVB6QyxVQUFLLEdBQWUsRUFBRSxDQUFDO1FBR3ZCLGNBQVMsR0FBb0IsRUFBRSxDQUFDO1FBRWhDLFVBQUssR0FBVyxFQUFFLENBQUM7UUFDbkIsaUJBQVksR0FBZ0IsSUFBSSxDQUFDO1FBRTdCLG9CQUEyQyxFQUExQyxrQkFBVSxFQUFFLG1CQUFXLENBQW9CO1FBQzVDLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxNQUFNLEVBQUUsQ0FBQyxFQUFFLEVBQUU7WUFDN0IsSUFBTSxHQUFHLEdBQWEsRUFBRSxDQUFDO1lBQ3pCLEtBQUssSUFBSSxDQUFDLEdBQUcsQ0FBQyxFQUFFLENBQUMsR0FBRyxLQUFLLEVBQUUsQ0FBQyxFQUFFLEVBQUU7Z0JBQzVCLEdBQUcsQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLENBQUM7YUFDZjtZQUNELElBQUksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFBO1NBQ3ZCO0lBQ0wsQ0FB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SUFBSSxlQUFLLENBQUMsS0FBSyxDQUFDLENBQUMsQ0FBQyxFQUFFLEtBQUssQ0FBQyxDQUFDLENBQUMsQ0FBQyxDQUFDO0FBQ3pELElBQU0sVUFBVSxHQUFHLElBQUksb0JBQVUsQ0FBQyxVQUFVLENBQUMsQ0FBQztBQUU5QyxZQUFZLENBQUMsZUFBZSxFQUFFLENBQUE7QUFDOUIsV0FBVyxDQUFDLGVBQWUsQ0FBQyxVQUFVLENBQUMsQ0FBQztBQUV4QyxRQUFRLENBQUMsY0FBYyxDQUFDLFNBQVMsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxZQUFZLENBQUMsWUFBWSxFQUFFLENBQUMsQ0FBQztBQUM1RSxRQUFRLENBQUMsY0FBYyxDQUFDLFFBQVEsQ0FBQyxDQUFDLFdBQVcsQ0FBQyxXQUFXLENBQUMsWUFBWSxFQUFFLENBQUMsQ0FBQztBQUUxRSxZQUFZLENBQUMsU0FBUyxDQUFDLFVBQVUsQ0FBQyxLQUFLLEVBQUUsQ0FBQyxDQUFDIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24oKXtmdW5jdGlvbiByKGUsbix0KXtmdW5jdGlvbiBvKGksZil7aWYoIW5baV0pe2lmKCFlW2ldKXt2YXIgYz1cImZ1bmN0aW9uXCI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFmJiZjKXJldHVybiBjKGksITApO2lmKHUpcmV0dXJuIHUoaSwhMCk7dmFyIGE9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitpK1wiJ1wiKTt0aHJvdyBhLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsYX12YXIgcD1uW2ldPXtleHBvcnRzOnt9fTtlW2ldWzBdLmNhbGwocC5leHBvcnRzLGZ1bmN0aW9uKHIpe3ZhciBuPWVbaV1bMV1bcl07cmV0dXJuIG8obnx8cil9LHAscC5leHBvcnRzLHIsZSxuLHQpfXJldHVybiBuW2ldLmV4cG9ydHN9Zm9yKHZhciB1PVwiZnVuY3Rpb25cIj09dHlwZW9mIHJlcXVpcmUmJnJlcXVpcmUsaT0wO2k8dC5sZW5ndGg7aSsrKW8odFtpXSk7cmV0dXJuIG99cmV0dXJuIHJ9KSgpIiwiaW50ZXJmYWNlIENvbmZpZyB7XG4gICAgYm9hcmQ6IG51bWJlcltdO1xuICAgIHNoaXBzU2l6ZXM6IG51bWJlcltdXG59XG5cbmV4cG9ydCBjb25zdCBjb25maWc6IENvbmZpZyA9IHtcbiAgICBib2FyZDogWzEwLCAxMF0sXG4gICAgc2hpcHNTaXplczogWzEsIDEsIDEsIDEsIDIsIDIsIDIsIDMsIDMsIDRdXG59XG5cbiIsImltcG9ydCBDZWxsIGZyb20gJy4vQ2VsbCc7XG5pbXBvcnQgU2hpcCBmcm9tICcuL1NoaXAnO1xuaW1wb3J0IFNoaXBTZXR0ZXIgZnJvbSAnLi9TaGlwU2V0dGVyJztcblxubGV0IGNvbG9yczogc3RyaW5nW10gPSBbXCJibHVlXCIsIFwicmVkXCIsIFwiZ3JlZW5cIiwgXCJ5ZWxsb3dcIl07XG5cbmludGVyZmFjZSBzaGlwU2V0dGluZyB7XG4gICAgeDogbnVtYmVyO1xuICAgIHk6IG51bWJlcjtcbiAgICBkaXJlY3Rpb246IGJvb2xlYW47XG4gICAgc2l6ZTogbnVtYmVyO1xufVxuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBCb2FyZCB7XG4gICAgYm9hcmQ6IG51bWJlcltdW10gPSBbXTtcbiAgICB3aWR0aDogbnVtYmVyO1xuICAgIGhlaWdodDogbnVtYmVyO1xuICAgIGh0bWxCb2FyZDogSFRNTEVsZW1lbnRbXVtdID0gW107XG4gICAgYm9hcmRDb250YWluZXI6IEhUTUxFbGVtZW50O1xuICAgIHNoaXBzOiBTaGlwW10gPSBbXTtcbiAgICBsYXN0UHJvcG9zZWQ6IHNoaXBTZXR0aW5nID0gbnVsbDtcbiAgICBjb25zdHJ1Y3Rvcih3aWR0aDogbnVtYmVyLCBoZWlnaHQ6IG51bWJlcikge1xuICAgICAgICBbdGhpcy53aWR0aCwgdGhpcy5oZWlnaHRdID0gW3dpZHRoLCBoZWlnaHRdO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGhlaWdodDsgaSsrKSB7XG4gICAgICAgICAgICBjb25zdCByb3c6IG51bWJlcltdID0gW107XG4gICAgICAgICAgICBmb3IgKGxldCBqID0gMDsgaiA8IHdpZHRoOyBqKyspIHtcbiAgICAgICAgICAgICAgICByb3cucHVzaCgwKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuYm9hcmQucHVzaChyb3cpXG4gICAgICAgIH1cbiAgICB9XG4gICAgY3JlYXRlSFRNTEJvYXJkKHNoaXBTZXR0ZXI6IFNoaXBTZXR0ZXIgPSBudWxsKSB7XG4gICAgICAgIHRoaXMuYm9hcmRDb250YWluZXIgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KFwiZGl2XCIpXG4gICAgICAgIHRoaXMuYm9hcmRDb250YWluZXIuY2xhc3NOYW1lID0gXCJib2FyZFwiO1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IHRoaXMuaGVpZ2h0OyBpKyspIHtcbiAgICAgICAgICAgIGNvbnN0IHJvdzogSFRNTEVsZW1lbnRbXSA9IFtdO1xuICAgICAgICAgICAgY29uc3Qgcm93RGl2ID0gZG9jdW1lbnQuY3JlYXRlRWxlbWVudCgnZGl2Jyk7XG4gICAgICAgICAgICByb3dEaXYuY2xhc3NOYW1lID0gXCJyb3dcIjtcbiAgICAgICAgICAgIGZvciAobGV0IGogPSAwOyBqIDwgdGhpcy53aWR0aDsgaisrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY2VsbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgICAgICAgICAgaWYgKHNoaXBTZXR0ZXIpIHtcbiAgICAgICAgICAgICAgICAgICAgY2VsbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZW92ZXInLCAoZSkgPT4gdGhpcy5jaGVja1NoaXAoZSwgc2hpcFNldHRlcikpO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBjZWxsLmNsYXNzTmFtZSA9IFwiY2VsbFwiO1xuICAgICAgICAgICAgICAgIGNlbGwuaWQgPSBgJHtqfS0ke2l9YDtcbiAgICAgICAgICAgICAgICByb3cucHVzaChjZWxsKTtcbiAgICAgICAgICAgICAgICByb3dEaXYuYXBwZW5kQ2hpbGQoY2VsbCk7XG5cbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuaHRtbEJvYXJkLnB1c2gocm93KVxuICAgICAgICAgICAgdGhpcy5ib2FyZENvbnRhaW5lci5hcHBlbmRDaGlsZChyb3dEaXYpO1xuICAgICAgICB9XG4gICAgfVxuICAgIGdldEhNVExCb2FyZCgpIHsgcmV0dXJuIHRoaXMuYm9hcmRDb250YWluZXIgfVxuICAgIGFkZFNoaXAoeDogbnVtYmVyLCB5OiBudW1iZXIsIGxlbmd0aDogbnVtYmVyLCBkaXJlY3Rpb246IGJvb2xlYW4gPSBmYWxzZSkge1xuICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxlbmd0aDsgaSsrKSB7XG4gICAgICAgICAgICBsZXQgW1gsIFldID0gW3gsIHldO1xuICAgICAgICAgICAgaWYgKGRpcmVjdGlvbikgWSA9IHkgKyBpO1xuICAgICAgICAgICAgZWxzZSBYID0geCArIGk7XG4gICAgICAgICAgICB0aGlzLmJvYXJkW1ldW1hdID0gMTtcbiAgICAgICAgICAgIHRoaXMuaHRtbEJvYXJkW1ldW1hdLmNsYXNzTGlzdC5hZGQoJ2JsdWUnKTtcbiAgICAgICAgfVxuICAgIH1cbiAgICBkcmF3U2hpcHMoc2hpcFNpemVzOiBudW1iZXJbXSkge1xuICAgICAgICB3aGlsZSAoc2hpcFNpemVzLmxlbmd0aCA+IDApIHtcbiAgICAgICAgICAgIGNvbnN0IHNpemUgPSBzaGlwU2l6ZXMucG9wKCk7XG4gICAgICAgICAgICBsZXQgZm91bmQgPSBmYWxzZTtcbiAgICAgICAgICAgIHdoaWxlICghZm91bmQpIHtcbiAgICAgICAgICAgICAgICBsZXQgW3gsIHksIGRpcmVjdGlvbl0gPSBbTWF0aC5mbG9vcihNYXRoLnJhbmRvbSgpICogdGhpcy53aWR0aCksIE1hdGguZmxvb3IoTWF0aC5yYW5kb20oKSAqIHRoaXMuaGVpZ2h0KSwgTWF0aC5yYW5kb20oKSA8IDAuNV07XG4gICAgICAgICAgICAgICAgaWYgKHggPiB0aGlzLndpZHRoIC0gc2l6ZSAmJiAhZGlyZWN0aW9uKSB7XG4gICAgICAgICAgICAgICAgICAgIGNvbnRpbnVlO1xuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBpZiAoeSA+IHRoaXMuaGVpZ2h0IC0gc2l6ZSAmJiBkaXJlY3Rpb24pIHtcbiAgICAgICAgICAgICAgICAgICAgY29udGludWU7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGlmIChzaXplID09PSA0KSB7XG5cbiAgICAgICAgICAgICAgICAgICAgdGhpcy5hZGRTaGlwKHgsIHksIHNpemUsIGRpcmVjdGlvbilcbiAgICAgICAgICAgICAgICAgICAgYnJlYWs7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnN0IFtzaGlwc1Bvcywgc3Vycm91bmRpbmdzXSA9IGdlbmVyYXRlQ2hlY2tQb3NpdGlvbnMoeCwgeSwgc2l6ZSwgdGhpcy53aWR0aCwgdGhpcy5oZWlnaHQsIGRpcmVjdGlvbik7XG4gICAgICAgICAgICAgICAgZm91bmQgPSB0aGlzLmNoZWNrUG9zaXRpb25zKHNoaXBzUG9zLCBzdXJyb3VuZGluZ3MpXG4gICAgICAgICAgICAgICAgaWYgKGZvdW5kKSB0aGlzLmFkZFNoaXAoeCwgeSwgc2l6ZSwgZGlyZWN0aW9uKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuICAgIH1cbiAgICBjaGVja1Bvc2l0aW9ucyhzaGlwczogbnVtYmVyW11bXSwgc3Vycm91bmRpbmdzOm51bWJlcltdW10pOiBib29sZWFueyAgICAgICAgXG4gICAgICAgICAgICAgICAgY29uc3QgcyA9IHNoaXBzLmZpbHRlcihwb3MgPT4ge1xuICAgICAgICAgICAgICAgICAgICByZXR1cm4gdGhpcy5ib2FyZFtwb3NbMV1dW3Bvc1swXV0gPT09IDBcbiAgICAgICAgICAgICAgICB9KVxuICAgICAgICAgICAgICAgIGNvbnN0IHN1ciA9IHN1cnJvdW5kaW5ncy5maWx0ZXIocG9zID0+IHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuYm9hcmRbcG9zWzFdXVtwb3NbMF1dID09PSAwXG4gICAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgICAgICByZXR1cm4gKHNoaXBzLmxlbmd0aCA9PT0gcy5sZW5ndGggJiYgc3Vycm91bmRpbmdzLmxlbmd0aCA9PT0gc3VyLmxlbmd0aClcbiAgICB9XG4gICAgdmlld1NoaXAoY29sb3I6IHN0cmluZywgczogc2hpcFNldHRpbmcpIHtcbiAgICAgICAgY29uc3QgeyB4LCB5LCBkaXJlY3Rpb24sIHNpemUgfSA9IHM7XG4gICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgc2l6ZTsgaSsrKSB7XG4gICAgICAgICAgICBsZXQgW1gsIFldID0gW3gsIHldO1xuICAgICAgICAgICAgaWYgKGRpcmVjdGlvbikgWSA9IHkgKyBpO1xuICAgICAgICAgICAgZWxzZSBYID0geCArIGk7ICAgICAgICAgICAgXG4gICAgICAgICAgICBpZihYID49IDAgJiYgWCA8IHRoaXMud2lkdGggJiYgWSA+PSAwICYmIFkgPCB0aGlzLmhlaWdodCl7XG4gICAgICAgICAgICAgICAgdGhpcy5ib2FyZFtZXVtYXSA9IDE7XG4gICAgICAgICAgICAgICAgdGhpcy5odG1sQm9hcmRbWV1bWF0uc3R5bGUuYmFja2dyb3VuZENvbG9yID0gY29sb3I7XG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhpcy5sYXN0UHJvcG9zZWQgPSBzO1xuICAgIH1cbiAgICBcbiAgICBjaGVja1NoaXAoZTogRXZlbnQsIHNoaXBTZXR0ZXI6IFNoaXBTZXR0ZXIpIHtcbiAgICAgICAgY29uc3QgZWwgPSBlLnRhcmdldCBhcyBIVE1MRWxlbWVudDtcbiAgICAgICAgY29uc3QgcG9zID0gZWwuaWQuc3BsaXQoXCItXCIpLm1hcChhID0+IHBhcnNlSW50KGEpKTsgICAgICAgIFxuICAgICAgICBjb25zdCBzaGlwOiBzaGlwU2V0dGluZyA9IHtcbiAgICAgICAgICAgIHg6IHBvc1swXSxcbiAgICAgICAgICAgIHk6IHBvc1sxXSxcbiAgICAgICAgICAgIGRpcmVjdGlvbjogc2hpcFNldHRlci5kaXJlY3Rpb24sXG4gICAgICAgICAgICBzaXplOiBzaGlwU2V0dGVyLnNlbGVjdGVkXG4gICAgICAgIH0gICAgICAgIFxuICAgICAgICBpZih0aGlzLmxhc3RQcm9wb3NlZCl7XG4gICAgICAgICAgICB0aGlzLnZpZXdTaGlwKFwiXCIsIHRoaXMubGFzdFByb3Bvc2VkKTtcbiAgICAgICAgfVxuICAgICAgICB0aGlzLnZpZXdTaGlwKFwicmVkXCIsIHNoaXApXG5cbiAgICB9XG5cbn1cblxuZnVuY3Rpb24gZ2VuZXJhdGVDaGVja1Bvc2l0aW9ucyh4OiBudW1iZXIsIHk6IG51bWJlciwgbGVuZ3RoOiBudW1iZXIsIHdpZHRoOiBudW1iZXIsIGhlaWdodDogbnVtYmVyLCBkaXJlY3Rpb246IGJvb2xlYW4gPSBmYWxzZSwgKTogbnVtYmVyW11bXVtdIHtcbiAgICBjb25zdCBwb3NpdGlvbnM6IG51bWJlcltdW10gPSBbXVxuICAgIGZvciAobGV0IGkgPSAtMTsgaSA8IDI7IGkrKykge1xuICAgICAgICBpZiAoIWRpcmVjdGlvbikge1xuICAgICAgICAgICAgZm9yIChsZXQgaiA9IC0xOyBqIDwgbGVuZ3RoICsgMTsgaisrKSB7XG4gICAgICAgICAgICAgICAgcG9zaXRpb25zLnB1c2goW3ggKyBqLCB5ICsgaV0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgZm9yIChsZXQgaiA9IC0xOyBqIDwgbGVuZ3RoICsgMTsgaisrKSB7XG4gICAgICAgICAgICAgICAgcG9zaXRpb25zLnB1c2goW3ggKyBpLCB5ICsgal0pO1xuICAgICAgICAgICAgfVxuICAgICAgICB9XG4gICAgfVxuICAgIGNvbnN0IHNoaXBQb3MgPSBwb3NpdGlvbnMuc3BsaWNlKGxlbmd0aCArIDMsIGxlbmd0aCk7XG4gICAgcmV0dXJuIFtzaGlwUG9zLCBwb3NpdGlvbnMuZmlsdGVyKHBvcyA9PiB7XG4gICAgICAgIHJldHVybiAocG9zWzBdID49IDAgJiYgcG9zWzBdIDwgd2lkdGgpICYmIChwb3NbMV0gPj0gMCAmJiBwb3NbMV0gPCBoZWlnaHQpXG4gICAgfSldO1xufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgU2hpcFNldHRlcntcbiAgICBzaGlwczogbnVtYmVyW107XG4gICAgY29udGFpbmVyOiBIVE1MRWxlbWVudDtcbiAgICBzZWxlY3RlZDogbnVtYmVyO1xuICAgIGRpcmVjdGlvbjogYm9vbGVhbjtcbiAgICBjb25zdHJ1Y3RvcihzaGlwczogbnVtYmVyW10pe1xuICAgICAgICB0aGlzLmRpcmVjdGlvbiA9IHRydWU7XG4gICAgICAgIHRoaXMuc2hpcHMgPSBzaGlwcy5zbGljZSgpO1xuICAgICAgICB0aGlzLmNvbnRhaW5lciA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwic2hpcHNcIik7XG4gICAgICAgIHRoaXMuc2VsZWN0ZWQgPSBNYXRoLm1heCguLi5zaGlwcyk7XG4gICAgICAgIGZvciAobGV0IGkgPSBzaGlwcy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkge1xuICAgICAgICAgICAgY29uc3Qgc2hpcCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgICAgICBzaGlwLmlkID0gYCR7c2hpcHNbaV19YDtcbiAgICAgICAgICAgIHNoaXAuY2xhc3NOYW1lID0gXCJzaGlwXCI7ICAgICAgICAgICAgXG4gICAgICAgICAgICBzaGlwLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCBlID0+IHtcbiAgICAgICAgICAgICAgICBjb25zdCBhID0gZG9jdW1lbnQuZ2V0RWxlbWVudHNCeUNsYXNzTmFtZShcInNlbGVjdGVkXCIpWzBdO1xuICAgICAgICAgICAgICAgIGEuY2xhc3NMaXN0LnJlbW92ZShcInNlbGVjdGVkXCIpO1xuICAgICAgICAgICAgICAgIGNvbnN0IGVsID0gZS5jdXJyZW50VGFyZ2V0IGFzIEhUTUxFbGVtZW50O1xuICAgICAgICAgICAgICAgIGVsLmNsYXNzTGlzdC5hZGQoJ3NlbGVjdGVkJyk7XG4gICAgICAgICAgICAgICAgdGhpcy5zZWxlY3RlZCA9IHBhcnNlSW50KGVsLmlkKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBzaGlwc1tpXTsgaisrKSB7XG4gICAgICAgICAgICAgICAgY29uc3QgY2VsbCA9IGRvY3VtZW50LmNyZWF0ZUVsZW1lbnQoXCJkaXZcIik7XG4gICAgICAgICAgICAgICAgc2hpcC5hcHBlbmRDaGlsZChjZWxsKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIHRoaXMuY29udGFpbmVyLmFwcGVuZENoaWxkKHNoaXApO1xuICAgICAgICB9XG4gICAgICAgIGRvY3VtZW50LmdldEVsZW1lbnRzQnlDbGFzc05hbWUoJ3NoaXAnKVswXS5jbGFzc0xpc3QuYWRkKFwic2VsZWN0ZWRcIik7XG4gICAgfVxuICAgIGdldENvbnRhaW5lciA9ICgpID0+IHRoaXMuY29udGFpbmVyOyAgICBcbn0iLCJpbXBvcnQge2NvbmZpZ30gZnJvbSBcIi4vLi4vY29uZmlnXCI7XG5pbXBvcnQgQm9hcmQgZnJvbSBcIi4vQm9hcmRcIjtcbmltcG9ydCBTaGlwU2V0dGVyIGZyb20gJy4vU2hpcFNldHRlcic7XG5cbmNvbnN0IHtib2FyZCwgc2hpcHNTaXplc30gPSBjb25maWc7XG5cbmNvbnN0IG1hY2hpbmVCb2FyZDogQm9hcmQgPSBuZXcgQm9hcmQoYm9hcmRbMF0sIGJvYXJkWzFdKTtcbmNvbnN0IHBsYXllckJvYXJkOiBCb2FyZCA9IG5ldyBCb2FyZChib2FyZFswXSwgYm9hcmRbMV0pO1xuY29uc3Qgc2hpcFNldHRlciA9IG5ldyBTaGlwU2V0dGVyKHNoaXBzU2l6ZXMpO1xuXG5tYWNoaW5lQm9hcmQuY3JlYXRlSFRNTEJvYXJkKClcbnBsYXllckJvYXJkLmNyZWF0ZUhUTUxCb2FyZChzaGlwU2V0dGVyKTtcblxuZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJtYWNoaW5lXCIpLmFwcGVuZENoaWxkKG1hY2hpbmVCb2FyZC5nZXRITVRMQm9hcmQoKSk7XG5kb2N1bWVudC5nZXRFbGVtZW50QnlJZChcInBsYXllclwiKS5hcHBlbmRDaGlsZChwbGF5ZXJCb2FyZC5nZXRITVRMQm9hcmQoKSk7XG5cbm1hY2hpbmVCb2FyZC5kcmF3U2hpcHMoc2hpcHNTaXplcy5zbGljZSgpKTtcblxuXG4iXX0=
